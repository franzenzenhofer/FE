/*! franze - v0.0.1 - last build: 2013-07-20 22:15:50 */
(function(){var n,t,e,r,a,u,l,i,o,g,h,s,f,c,m,v,d,w,b,y=[].slice;e={};d=window||(typeof module!=="undefined"&&module!==null?module.exports:void 0)||this;d.FE=e;w=false;r=0;b=function(n){return n};t=800;n=600;l=function(n){if(w){return typeof console!=="undefined"&&console!==null?console.log(n):void 0}};u=function(n,t){if(t==null){t="Debug Error"}if(w){throw new Error(t+": "+n)}};a=function(n,t){var e;e=[];while(!n){throw new Error("Callback required for "+t)}return e};f=function(n){var t;t={};return n&&t.toString.apply(n)==="[object Function]"};m=function(){var n,t;n=arguments[0],t=2<=arguments.length?y.call(arguments,1):[];if(n&&f(n)){d.setTimeout.apply(d,[n,r].concat(y.call(t)))}if(t.length===1){return t[0]}return t};c=function(){var n,t,e,r,a,u,i,o,g,h;i=arguments[0],t=2<=arguments.length?y.call(arguments,1):[];l("call to lff");l(i);l(t);r=null;a=[];e=0;e=i.length-1;while(e>=0){u=i[e];if(f(u)&&!r){r=u}else{a.unshift(u)}e=e-1}o=function(n){var t;return(t=a[e])!=null?t:a[e]=n};for(e=g=0,h=t.length;g<h;e=++g){n=t[e];o(n)}if(!r){r=b}a.unshift(r);return a};v=function(){var n,t,e,r,a,u,l,i;r=arguments[0],n=2<=arguments.length?y.call(arguments,1):[];a=[];u=function(t,e){return a[e]=typeof p!=="undefined"&&p!==null?p:n!=null?n[e]:void 0};for(t=l=0,i=r.length;l<i;t=++l){e=r[t];u(e,t)}return a};e.clamp=i=function(n,t,e){if(t==null){t=0}if(e==null){e=255}return Math.min(e,Math.max(t,n))};e.pos=h=function(n){if(n<0){return n*-1}else{return n}};e.getCanvasToolbox=function(n,t){var e,r,a;e=n.getContext("2d");l(e);l(n);l(n.width);l(n.height);r=e.getImageData(0,0,n.width,n.height);a=r.data;return m(t,[n,e,r,a])};e.make=function(){var e,r,a,u,i,o,g,h,s,f;h=1<=arguments.length?y.call(arguments,0):[];f=e=c(h,t,n),a=f[0],o=f[1],i=f[2],g=f[3];l("in make");l(e);if(o.width&&o.height){u=o;s=u.width;i=u.height;g=(u!=null?typeof u.getAttribute==="function"?u.getAttribute("id"):void 0:void 0)||(u!=null?typeof u.getAttribute==="function"?u.getAttribute("data-origin"):void 0:void 0)}else{s=o}r=d.document.createElement("canvas");r.width=s;r.height=i;if(g){r.setAttribute("origin",g)}l(r);return m(a,r)};e.newCanvasToolbox=function(){var n,t,r,a,u,l;a=1<=arguments.length?y.call(arguments,0):[];l=c(a),n=l[0],u=l[1],t=l[2],r=l[3];return e.getCanvasToolbox(e.make(u,t,r),n)};e.newCanvasToolboxByCanvas=function(n,t){return e.getCanvasToolbox(e.make(n.width,n.height,e.origin(n)),t)};e.copy=function(){var n,t,r,a,u,i,o,g;n=arguments[0],u=2<=arguments.length?y.call(arguments,1):[];i=c(u),a=i[0],t=i[1];if(t){o=e.getCanvasToolbox(n),t=o[0],r=o[1]}else{g=e.newCanvasToolbox(n),t=g[0],r=g[1]}l("hiho");r.drawImage(n,0,0,n.width,n.height);l("cb of copy");l(a);return m(a,t)};e.byImage=function(n,t){if(n.width&&n.height){l("loaded");return e.copy(n,t)}else{a(t,'FE.byImage (only if the image is not "loaded")');if(f(t)){n.onload=function(){return e.byImage(n,t)}}return true}};e.byArray=function(n,t,r,a){var u,l,i,o,g,h,s,f,c,v;v=e.newCanvasToolbox(t,r),u=v[0],l=v[1],o=v[2],g=v[3];i=0;s=function(t,e){return g[e]=n[e]};for(i=f=0,c=g.length;f<c;i=++f){h=g[i];s(h,i)}l.putImageData(o,0,0);return m(a,u)};e.toImage=function(){var n,t,r,a,u,l;u=1<=arguments.length?y.call(arguments,0):[];l=c(u,e.make(),"image/png"),t=l[0],n=l[1],a=l[2];r=new Image;r.src=n.toDataURL(a,"");return m(t,r)};e.toArray=function(n,t){var e,r,a,u,l,i;e=[];i=getToolbox(n),n=i[0],r=i[1],u=i[2],l=i[3];if(Uint8Array){e=new Uint8Array(new ArrayBuffer(l.length))}a=0;while(a<l.length){e[a]=l[a];a=a+1}return m(t,e)};e.newUint8Array=function(n,t){return m(t,new Uint8Array(new ArrayBuffer(n)))};e.rgba=s=function(){var n,t,r,a,l,i,o,g,h,s,v,d,w,b,p,x,C,I,T,A,M,z,E;r=arguments[0],d=2<=arguments.length?y.call(arguments,1):[];A=c(d,null,false),a=A[0],i=A[1];if(!f(i)){u("Filter not a function","FE.rgba error");m(a,false)}M=e.getCanvasToolbox(r),r=M[0],l=M[1],s=M[2],w=M[3];z=[r.width,r.height],x=z[0],g=z[1];p=e.newUint8Array(w.length);I=0;while(I<g){C=0;T=I*x;while(C<x){h=(T+C)*4;b=h;o=h+1;t=h+2;n=h+3;E=i(w[b],w[o],w[t],w[n],h),p[b]=E[0],p[o]=E[1],p[t]=E[2],p[n]=E[3];C=C+1}I=I+1}v=e.byArray(p,x,g);return m(a,v)};e.getGrayscaleValue=o=function(){var n,t,e,r,a,u,l;u=arguments[0],r=arguments[1],t=arguments[2],a=4<=arguments.length?y.call(arguments,3):[];l=c(a),e=l[0],n=l[1];return m(e,u*.3+r*.59+t*.11)};e.getSyncGrayscaleValue=g=function(n,t,e){return n*.3+t*.59+e*.11};e.origin=function(n,t){return m(t,(n!=null?n.getAttribute("id"):void 0)||(n!=null?n.getAttribute("data-origin"):void 0))};e.hardResize=function(n,t,r,a){var u,l,i;i=e.newCanvasToolbox(t,r),u=i[0],l=i[1];l.drawImage(n,0,0,t,r);return m(a,u)};e.pixelyResize=function(n,t,r,a){var u,l,i;i=e.newCanvasToolbox(t,r),u=i[0],l=i[1];if(l!=null){l.webkitImageSmoothingEnabled=false}if(l!=null){l.imageSmoothingEnabled=false}if(l!=null){l.mozImageSmoothingEnabled=false}l.drawImage(n,0,0,t,r);return m(a,u)};e.mosaic=function(n,t,r,a){var u,l;u=e.pixelyResize(n,t,r);l=e.pixelyResize(u,n.width,n.height);return m(a,l)};e.scale=function(){var n,t,r,a,u,l,i,o,g,h;n=arguments[0],i=2<=arguments.length?y.call(arguments,1):[];g=c(i,1),t=g[0],o=g[1];l=n.width*o;u=n.height*o;h=e.newCanvasToolboxByCanvas(n),r=h[0],a=h[1];a.drawImage(n,0,0,l,u);return m(t,r)};e.crop=function(){var n,t,r,a,u,l,i,o,g,h,s;n=arguments[0],g=2<=arguments.length?y.call(arguments,1):[];h=c(g,0,0,n.width/2,n.height/2),t=h[0],u=h[1],l=h[2],a=h[3],r=h[4];s=e.newCanvasToolbox(a,r,e.origin(n)),i=s[0],o=s[1];o.drawImage(n,u,l,a,r,0,0,a,r);return m(t,i)};e.resize=function(){var t,r,a,u,i,o,g,h,s,f,v,d;t=arguments[0],h=2<=arguments.length?y.call(arguments,1):[];u={width:null,height:null};i={width:null,height:null};v=c(h,n,null,null,null),r=v[0],u["width"]=v[1],u["height"]=v[2],i["width"]=v[3],i["height"]=v[4],a=v[5];f=null;s={width:null,height:null};if(a==="width"){f="height"}else if(a==="height"){f="width"}else{if(t.height>t.width){a="height";f="width";l("hochformat")}else{a="width";f="height";l("querformat")}}if((u!=null?u[a]:void 0)&&((t!=null?t[a]:void 0)>(u!=null?u[a]:void 0)||(t!=null?t[f]:void 0)>(u!=null?u[f]:void 0))){s[f]=t[f]*u[a]/t[a];s[a]=u[a];if((u!=null?u[f]:void 0)&&(s!=null?s[f]:void 0)>(u!=null?u[f]:void 0)){s[a]=t[a]*u[f]/t[f];s[f]=u[f]}}else if((i!=null?i[a]:void 0)&&((t!=null?t[a]:void 0)<(i!=null?i[a]:void 0)||(t!=null?t[f]:void 0)>(i!=null?i[f]:void 0))){s[a]=t[a]*i[f]/t[f];s[f]=i[f];if((i!=null?i[a]:void 0)&&(s!=null?s[a]:void 0)<(i!=null?i[a]:void 0)){s[f]=t[f]*i[a]/t[a];s[a]=i[a]}}else{s[a]=t[a];s[f]=t[f]}l("in resize");l(s);d=e.newCanvasToolbox(s.width,s.height,e.origin(t)),o=d[0],g=d[1];g.drawImage(t,0,0,s.width,s.height);return m(r,o)};e.scaleDownTo=function(){var n,t,r,a,u,l;n=arguments[0],u=2<=arguments.length?y.call(arguments,1):[];l=c(u),t=l[0],a=l[1],r=l[2];return e.resize(n,a,r,t)};e.scaleUpTo=function(){var n,t,r,a,u,l;n=arguments[0],u=2<=arguments.length?y.call(arguments,1):[];l=c(u),t=l[0],a=l[1],r=l[2];debugger;return e.resize(n,null,null,a,a,t)};e.rotateRight=function(n,t){var r,a,u;u=e.newCanvasToolbox(n.height,n.width),r=u[0],a=u[1];a.rotate(90*Math.PI/180);a.drawImage(n,0,n.height*-1);return m(t,r)};e.rotateLeft=function(n,t){var r,a,u;u=e.newCanvasToolbox(n.height,n.width),r=u[0],a=u[1];a.rotate(90*-1*Math.PI/180);a.drawImage(n,n.width*-1,0);return m(t,r)};e.flip=function(n,t){var r,a,u;u=e.newCanvasToolbox(n),r=u[0],a=u[1];a.rotate(Math.PI);a.drawImage(n,n.width*-1,n.height*-1);return m(t,r)};e.mirror=function(n,t){var r,a,u;u=e.newCanvasToolbox(n),r=u[0],a=u[1];a.translate(r.width/2,0);a.scale(-1,1);a.drawImage(n,r.width/2*-1,0);return m(t,r)};e.rgbaMultiply=function(){var n,t,r,a,u,l,o,g;r=arguments[0],l=2<=arguments.length?y.call(arguments,1):[];g=c(l,1,1,1,1),a=g[0],o=g[1],u=g[2],t=g[3],n=g[4];return e.rgba(r,a,function(e,r,a,l){return[i(l*n),i(r*u),i(a*t),i(l*n)]})};e.brighter=function(){var n,t,r,a;n=arguments[0],r=2<=arguments.length?y.call(arguments,1):[];a=c(r,1),t=a[0],r=a[1];return e.rgbaMultiply(n,r,r,r,1,t)};e.darker=function(){var n,t,r,a;n=arguments[0],r=2<=arguments.length?y.call(arguments,1):[];a=c(r,1),t=a[0],r=a[1];r=2-r;return e.rgbaMultiply(n,r,r,r,1,t)};e.opacity=function(){var n,t,r,a,u;n=arguments[0],a=2<=arguments.length?y.call(arguments,1):[];u=c(a,1),t=u[0],r=u[1];return e.rgbaMultiply(n,1,1,1,r,t)};e.nothing=function(){var n,t,r,a;n=arguments[0],a=2<=arguments.length?y.call(arguments,1):[];t=c(a)[0];r=function(n,t,e,r){return[n,t,e,r]};return e.rgba(n,r,t)};e.invert=function(){var n,t,r,a,u;n=arguments[0],r=2<=arguments.length?y.call(arguments,1):[];u=c(r,1),t=u[0],r=u[1];while(!(r>=0&&r<=1)){r=1}a=r*255;return e.rgba(n,function(n,t,e,r){return[h(a-n),h(a-t),h(a-e),r]},t)};e.saturate=function(){var n,t,r,a,u,l;n=arguments[0],a=2<=arguments.length?y.call(arguments,1):[];l=c(a,.3),t=l[0],u=l[1];r=function(n,t,e,r){var a;a=(n+t+e)/3;return[i(a+u*(n-a)),i(a+u*(t-a)),i(a+u*(e-a)),r]};return e.rgba(n,r,t)};e.desaturate=function(){var n,t,r,a,u;n=arguments[0],r=2<=arguments.length?y.call(arguments,1):[];u=c(r,.7),t=u[0],a=u[1];return e.saturate(n,1-a,t)};e.fill=function(){var n,t,r,a,u,l,i;t=arguments[0],u=2<=arguments.length?y.call(arguments,1):[];i=c(u,0,0,0),r=i[0],l=i[1],a=i[2],n=i[3];return e.rgba(t,function(t,e,r,u){return[clamp(l),clamp(a),clamp(n),u]},r)};e.posterize=function(){var n,t,r,a,u,l,o;n=arguments[0],u=2<=arguments.length?y.call(arguments,1):[];o=c(u,5),t=o[0],a=o[1];l=Math.floor(255/a);r=function(n,t,e,r){var a,u,o;o=i(Math.floor(n/l)*l);u=i(Math.floor(t/l)*l);a=i(Math.floor(e/l)*l);return[o,u,a,r]};return e.rgba(n,r,t)};e.gray=function(n,t){var e;e=function(n,t,e,r){var a;a=(n+t+e)/3;return[a,a,a,r]};return rgba(n,e,t)};e.grayScale=function(n,t){var e;e=function(n,t,e,r){var a;a=g(n,t,e);return[a,a,a,r]};return rgba(n,e,t)};e.tint=function(){var n,t,r,a,u,l,o,g,h,s,f,m,v;n=arguments[0],s=2<=arguments.length?y.call(arguments,1):[];m=85;f=170;v=c(s,m,m,m,f,f,f),t=v[0],h=v[1],g=v[2],o=v[3],l=v[4],a=v[5],u=v[6];if(h===l){l=l+1}if(g===u){u=u+1}if(o===a){a=a+1}r=function(n,t,e,r){var s,f,c;c=i((n-h)*(255/(l-h)));f=i((t-h)*(255/(u-g)));s=i((e-o)*(255/(a-o)));return[c,f,s,r]};return e.rgba(n,r,t)};e.sepia=function(n,t){var r;r=function(n,t,e,r){var a,u,l;l=n*.393+t*.769+e*.189;u=n*.349+t*.686+e*.168;a=n*.272+t*.534+e*.131;return[i(l),i(u),i(a),r]};return e.rgba(n,r,t)};e.solarize=function(n,t){var r;r=function(n,t,e,r){return[n>127?255-n:n,t>127?255-t:t,e>127?255-e:e,r]};return e.rgba(n,r,t)};e.screen=function(){var n,t,r,a,u,l,i,o,g;t=arguments[0],l=2<=arguments.length?y.call(arguments,1):[];g=fff(l,227,12,169,.2),r=g[0],i=g[1],u=g[2],n=g[3],o=g[4];a=function(t,e,r,a){return[255-(255-t)*(255-i*o)/255,255-(255-e)*(255-u*o)/255,255-(255-r)*(255-n*o)/255,a]};return e.rgba(t,a,r)};e.noise=function(){var n,t,r,a,u,l,o,g,h,s,f,v,d,w,b,p,x;t=arguments[0],v=2<=arguments.length?y.call(arguments,1):[];p=c(v,20),r=p[0],n=p[1];x=e.getCanvasToolbox(copy(t)),o=x[0],g=x[1],h=x[2],s=x[3];for(u=w=0,b=s.length;w<b;u=++w){d=s[u];f=Math.round(n-Math.random()*n/2);a=0;l=0;while(l<3){s[u+l]=i(f+s[u+l]);l=l+1}}g.putImageData(h,0,0);return m(r,o)}}).call(this);